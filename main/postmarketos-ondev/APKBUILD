# Maintainer: Oliver Smith <ollieparanoid@postmarketos.org>
pkgname=postmarketos-ondev
pkgver=2.0.0
pkgrel=0
pkgdesc="Next-gen on-device installer (pmOS specific build)"
url="https://gitlab.com/postmarketOS/ondev2/"
arch="all"
license="GPL-3.0-or-later"
depends="
	$pkgname-lang
	$pkgname-openrc
	haveged
	haveged-openrc
	losetup
	tmux
	"
subpackages="$pkgname-openrc $pkgname-lang"
install="$pkgname.post-install"
source="https://gitlab.com/postmarketOS/ondev2/-/archive/$pkgver/ondev2-$pkgver.tar.gz"
options="!check"  # has no tests
makedepends="
	eudev-dev
	gettext-tiny
	inih-dev
	libdrm-dev
	libinput-dev
	libxkbcommon-dev
	linux-headers
	musl-libintl
	pkgconf
"

build() {
	make ${JOBS:+-j ${JOBS}}
}

package() {
	make DESTDIR="$pkgdir" install-postmarketOS
}

sha512sums="
"
